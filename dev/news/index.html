<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Changelog â€¢ EpiNow2</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Changelog" />
<meta property="og:image" content="epiforecasts.io/EpiNow2/reference/figures/unnamed-chunk-13-1.png" />
<meta property="og:image:alt" content="Example estimates produced by EpiNow2 of the reproduction number, cases by date of infection and cases by date of report" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@seabbs" />
<meta name="twitter:site" content="@cmmid_lshtm" />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-news">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EpiNow2</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">1.3.0.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/epiforecasts/EpiNow2">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
      <h1 data-toc-skip>Changelog <small></small></h1>
      
    </div>

    <div id="epinow2-130" class="section level1">
<h1 class="page-header" data-toc-text="1.3.0">
<a href="#epinow2-130" class="anchor"></a>EpiNow2 1.3.0<small> Unreleased </small>
</h1>
<div id="new-features" class="section level2">
<h2 class="hasAnchor">
<a href="#new-features" class="anchor"></a>New features</h2>
<ul>
<li>Rewritten the interface for <code>estimate_infections</code> to be divided into calls to <code>_opts</code> functions. Options are now divided by type for delays (<code>delay_opts</code>), Rt (<code>rt_opts</code>), backcalculation (<code>backcalc_opts</code>), the Gaussian process (<code>gp_opts</code>), and stan arguments (<code>stan_opts</code>). This has resulted in a larger number of the arguments from <code>estimate_infections</code> being folded into the related <code>_opts</code> function. Please see the function documentation and examples for details.</li>
<li>Added support for region specific settings for all arguments that take an <code>_opts</code> function in <code>regional_epinow</code> using the helper functions <code>opts_list</code> and <code>update_list</code> or alternatively by constructing a named list with an entry for each region to be estimated.</li>
<li>Extended the functionality of the back calculation model so that Rt can be produced via calculation. These estimates are potentially less reliable than those produced using the generative model but the model can be estimated in a fraction of the time. In essence this is similar to using a back projection method and then estimating Rt using <code>{EpiEstim}</code> (here with a default window of 1 but this can be updated using <code>backcalc_opts(rt_window))</code> but this approaches incorporates uncertainty from all inputs in a single estimate.</li>
<li>Reduced the default maximum generation time and incubation period allowed in the truncated distribution (from 30 days to 15). This decreases the model run time substantially at a marginal accuracy cost. This new default is not suitable for longer generation times and should be modified by the user if these are used.</li>
<li>Adds basic S3 plot and summary measures for <code>epinow</code> and <code>estimate_infections</code>.</li>
<li>Updates the initialisation of the generative Rt model (the default) so that initial infections that occur in unobserved time (i.e before the first reported case) are generated using an exponential growth model with priors based on fitting the same model to the first week of data. This replaces the previous approach which was to use delay shifted reported cases multiplied by independent noise terms. It reduces degrees of freedom and fitting time at the cost of some model flexibility. Alternatives such as using the generative Rt model were considered but ultimately these approaches were not used as they introduced spurious variation to the gaussian process and result in unreliable Rt estimates due to the lack of historic infections.</li>
<li>New <code>simulate_infections</code> function from @sbfnk which allows the simulation of different Rt traces when combined with estimates as produced by <code>estimate_infections</code>. This function is likely to form the basis for moving all forecasting out of <code>estimate_infections</code> which may improve model stability.</li>
<li>Updates the implementation of the Gaussian process to support the Matern 3/2 Kernel (and set this as the default) in addition to the squared exponential kernel. Updates the handling of Gaussian process arguments so that only overridden settings need to be passed by the user when making changes. Settings are now defined, and documented, in <code>gp_opts</code>. The length scale is now defined using a log normal truncated prior with a mean of 21 days and a standard deviation of 7 days truncated at 3 days and the length of the data by default. This prior is an area of active research and so may change in future releases.</li>
<li>Updates the over dispersion prior to be <code>1 / sqrt(half_normal(0, rho_prior))</code> based on <a href="https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations">this</a> advice and as the over dispersion being measured is in reports and not infections and hence a priori there is not strong evidence for over dispersion (which may be the case for infections) so the previous prior was overly weighted towards this.</li>
<li>Updates the interface for the observation model with arguments now passed using <code>obs_opts</code>. This removes <code>week_effect</code> and <code>family</code> from the main argument list which will allow for future extensions. Also adds a new argument <code>scale</code> which controls the uncertain fraction of cases that are eventually observed (defined as normally distributed). Setting this parameter will not impact Rt estimates.</li>
<li>Updates the interface to the Rt settings with all arguments passed via <code>rt</code>, using <code>rt_opts</code>, this includes the initial prior,<code>use_breakpoints</code>, and <code>future</code>. Adds a new helper argument <code>rw</code> which enables easy parameterisation of a fixed length random walk. These changes also help make it clear that these arguments only impact the Rt generative model and not the back calculation model.</li>
<li>Adds an adjustment for population susceptibility based on that used in <a href="https://github.com/ImperialCollegeLondon/epidemia"><code>{epidemia}</code></a> when Rt is fixed into the future (set by passing a population to <code>rt_opts(pop = initial susceptible population)</code>. Note this only impacts case forecasts and not output Rt estimates and only impacts estimates at all beyond the forecast horizon as those based on data already account for population susceptibility by definition. The impact of this assumption can be explored using <code>simulate_infections</code> (by updating <code>est$arg$pop</code> in the example).</li>
<li>Adds <code>truncation</code> as a new argument to <code>estimate_infections</code> and higher level functions. This takes output from <code>trunc_opts</code> and allows for internally adjusting observed cases for truncation. A new method <code>estimate_truncation</code> has also been added to support estimating a log normal truncation distribution from archived versions of the same data set though this method is currently experimental.</li>
<li>Adds <code>estimate_delay</code> as a user friendly wrapper around <code>bootstrapped_dist_fit</code>.</li>
</ul>
</div>
<div id="other-changes" class="section level2">
<h2 class="hasAnchor">
<a href="#other-changes" class="anchor"></a>Other changes</h2>
<ul>
<li>Recoded the core stan model to be functional with the aim of making the code modular and extendable.</li>
<li>Added unit tests for the internal stan update_rt function.</li>
<li>Reworked the package logging system to improve the reporting of issues both in <code>epinow</code> and in <code>regional_epinow</code> for large batch runs.</li>
<li>Fix from @hsbadr to prevent overflow when overdispersion is larger (by switching to a Poisson approximation). Hitting this issue may indicate a bug in other model code that will need further work to explore.</li>
<li>Moved default verbosity for all functions (excepting <code>regional_epinow</code>) to be based on whether or not usage is interactive.</li>
<li>Removed the <code>burn_in</code> argument of <code>estimate_infections</code> as updates to model initialisation mean that this feature is likely no longer needed. Please contact the developers if you feel you have a use case for this argument.</li>
<li>Adds utility functions to map between mean and standard deviation and the log mean and log standard deviation for a log normal distribution (<code>convert_to_logmean</code> and <code>convert_to_logsd</code>).</li>
<li>Optimised all discrete probability mass functions to be as vectorised as possible.</li>
<li>Updated the Gaussian process to be internally on the unit scale.</li>
<li>Added a new function, <code>expose_stan_fns</code> that exposes the internal stan functions into R. The enables unit testing, exploration of the stan functionality and potentially within R use cases for these functions.</li>
<li>Updates the default <code>warmup</code> to be 250 samples and the default <code>adapt_delta</code> to be 0.98.</li>
<li>Adds a pooling parameter for the standard deviation of breakpoint effects.</li>
<li>Updated all documentation and added <a href="https://lifecycle.r-lib.org/">lifecycle</a> badges to all functions to indicate develoment stage.</li>
</ul>
</div>
</div>
    <div id="epinow2-121" class="section level1">
<h1 class="page-header" data-toc-text="1.2.1">
<a href="#epinow2-121" class="anchor"></a>EpiNow2 1.2.1<small> 2020-10-20 </small>
</h1>
<p>This release introduces multiple breaking interface changes. Please see the README for examples of the new interface. It adds a range of quality of life improvements including updating the <code>stan</code> interface to support fitting each chain independently and offering variational inference as an alternative, experimental, fitting option. Notably it also adds support for nesting logging and a parallel enabled progress bar via the <code>progressr</code> package. Minor bugs have been fixed in the core model implementation focussing on stability and several already implemented features have been extended. Major model developments are planned for the next release of <code>EpiNow2</code>.</p>
<div id="new-features-1" class="section level2">
<h2 class="hasAnchor">
<a href="#new-features-1" class="anchor"></a>New features</h2>
<ul>
<li>Added support for either NUTs sampling (<code>method = "exact"</code>) or Variational inference (<code>method = "approximate"</code>).</li>
<li>Update the prior on the initial Rt estimate to be lognormal rather than gamma distributed. For users the interface remains unchanged but this parameterisation should be more numerically stable.</li>
<li>Added <code>get_dist</code>, <code>get_generation_time</code>, <code>get_incubation_period</code> based on ideas from @pearsonca. (This leads to breaking changes with the removal of <code>covid_generation_times</code> and <code>covid_incubation_periods</code>).</li>
<li>Added <code>setup_logging</code> to enable users to specify the level and location of logging (wrapping functionality from <code>futile.logger</code>). Also added <code>setup_default_logging</code> to give users sensible defaults and embedded this function in <code>regional_epinow</code> and <code>epinow</code>.</li>
<li>Added <code>setup_future</code> to making using nested futures easier (required when using <code>future = TRUE</code>).</li>
<li>Implemented progress bar support using <code>progressr</code>.</li>
<li>Added timeout and timing option to <code>regional_epinow</code>
</li>
<li>Improved logging of warnings in <code>regional_epinow</code>
</li>
<li>Enabled the user to specify the credible intervals desired with 20%, 50% and 90% calculated by default. Also switched from high density regions to quantiles. Custom credible intervals are now supported in all reporting and plotting functions.</li>
<li>Added mean and sd to all reporting summaries.</li>
<li>Added a summary of the growth rate and doubling time.</li>
<li>Added a new function <code>regional_runtimes</code> that summarises the run time across regions.</li>
<li>Updated the <code>estimate_infections</code> interface and expanded the range of options for the <code>future_rt</code> argument. Users can now choose to set Rt from any time point referenced to the forecast date.</li>
</ul>
</div>
<div id="bug-fixes" class="section level2">
<h2 class="hasAnchor">
<a href="#bug-fixes" class="anchor"></a>Bug fixes</h2>
<ul>
<li>Fixed y axis max for <code>plot_summary</code>.</li>
<li>Fix to normalisation of delay and generation time distributions from @sbfnk. This will impact nowcast infections but not reproduction number estimate.</li>
<li>Updated <code>discretised_gamma_pmf</code> (discretised truncated Gamma PMF) to constrain gamma shape and (inverse) scale parameters to be positive and finite (<code>alpha &gt; 0</code> and <code>beta &gt; 0</code>).</li>
<li>Fixed <code>readLines</code> incomplete final line warnings.</li>
<li>Fix from @medewitt from the internal <code>fit_chain</code> function where an interaction between <code>rstan</code> and timing out may have introduced an exception that caused whole regions to fail. This did not show on current unit tests or exploration using examples indicating a gap in testing.</li>
</ul>
</div>
<div id="other-changes-1" class="section level2">
<h2 class="hasAnchor">
<a href="#other-changes-1" class="anchor"></a>Other changes</h2>
<ul>
<li>Updates the interface for specifying how output is returned.</li>
<li>Moved all inherited from stan arguments into <code>create_stan_args</code> with the option to override using <code>stan_args</code>. This leads to breaking changes - see the examples for details of the new interface.</li>
<li>Updated all example and documentation to reflect the new interface.</li>
<li>Added a <code>samples</code> argument to <code>get_regional_results</code> to make loading in samples optional. This also allows samples to be dropped when using <code>regional_epinow</code> which reduces RAM usage.</li>
<li>Cleaned up wrapper functions to move individual jobs into functions.</li>
<li>Adds testing of high level functions and some low level unit testing.</li>
<li>Adds a csv download button the interactive table in the regional summary table.</li>
<li>Makevars updated to remove the dependency on GNU Make by @hsbadr</li>
</ul>
</div>
</div>
    <div id="epinow2-110" class="section level1">
<h1 class="page-header" data-toc-text="1.1.0">
<a href="#epinow2-110" class="anchor"></a>EpiNow2 1.1.0<small> 2020-09-01 </small>
</h1>
<ul>
<li>Implemented reporting templates</li>
<li>Bug fix of estimate reporting</li>
<li>Added additional reporting of runtime errors</li>
<li>Examples for <code>global_map</code> and <code>country_map</code> expanded by @ellisp</li>
<li>Improved ISO code matching in <code>global_map</code> from @ellisp</li>
<li>Improvements so that data frames and tibbles are supported as inputs.</li>
<li>Updated reporting templates</li>
<li>Updated reporting of estimates to clearly summarise cases by infection and report date.</li>
<li>Made all region summary plots optional.</li>
<li>Made reporting of decimal places more standardised across metrics.</li>
<li>README updated by @kathsherratt</li>
<li>Logging added by @joeHickson</li>
<li>Updated plotting to be limited to a scaling of reported data (prevents upper CIs from skewing the plot).</li>
<li>Added uncertainty plot bounds to control y axis on plots for clarity purposes.</li>
<li>
<code>regional_summary</code> now saves input reported cases data <code>reported_cases.csv</code>.</li>
<li>Added an optional no delay model where Rt is estimated directly from the data. This option is not supported when using backcalculation only.</li>
</ul>
</div>
    <div id="epinow2-100" class="section level1">
<h1 class="page-header" data-toc-text="1.0.0">
<a href="#epinow2-100" class="anchor"></a>EpiNow2 1.0.0<small> Unreleased </small>
</h1>
<ul>
<li>Rebased package from <a href="https://epiforecasts.io/EpiNow/">EpiNow</a>
</li>
<li>Implemented backcalculation, estimation, forecasting, and bootstrapped distribution fitting.</li>
<li>Added options to estimate the time-varying reproduction number using a Gaussian process (both stationary and non-stationary), combined with optional user supplied breakpoints. Alternatively a static reproduction number can be assumed which when combined with breakpoints becomes piecewise linear.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>

</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://www.samabbott.co.uk/'>Sam Abbott</a>, Joel Hellewell, Robin Thompson, Katelyn Gostic, Katharine Sherratt, Hamada S. Badr, Michael DeWitt, Sophie Meakin, James Munday, Nikos Bosse, Joe Hickson, EpiForecasts, <a href='https://www.lshtm.ac.uk/aboutus/people/funk.sebastian'>Sebastian Funk</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '43da981922253a06c4dfab7b53f2410e',
    indexName: 'epinow2',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


